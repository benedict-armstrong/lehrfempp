<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LehrFEM++: Quick Reference - Degrees of Freedom (DOF) Handlers and Indexing</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "bm.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
// This file defines a number of macros which can be used in 
// formulas of the doxygen documentation.
MathJax.Hub.Config({
  jax: ["input/TeX", "output/CommonHTML", "output/HTML-CSS"],
  TeX: {
    extensions: ['AMSsymbols.js'],
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      grad: "\\vec{\\operatorname{grad}}",
      norm: ["\\left\\lVert#1\\right\\rVert", 1]
    }
  }
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <!-- Doxygen Awesome Paragraph Link Extension-->
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeParagraphLink.init()
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="logo.gif"  /></td>
              <td id="projectalign">
                <div id="projectname">LehrFEM++<span
                    id="projectnumber">&#160;1.0.0</span>
                </div>
                <div id="projectbrief">A simple Finite Element Library for teaching</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('quick_reference_dofs.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Quick Reference - Degrees of Freedom (DOF) Handlers and Indexing</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md178">Overview</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md179">DOF Handler</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md180">Local to Global Index Mapping</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md181">Example: UniformFEDofHandler</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md182">Special Conventions</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md183">Important Methods</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md184">Example Code</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2lehrfempp_2lehrfempp_2doc_2doxygen_2pages_2quick__reference__dofs"></a></p>
<h1><a class="anchor" id="autotoc_md178"></a>
Overview</h1>
<p>In finite element methods (FEM), handling degrees of freedom (DOFs) is critical for constructing systems of equations. DOF handlers or DOF mappers are responsible for assigning local basis functions to global basis functions, which allows for the assembly of global matrices and vectors from element contributions.</p>
<h2><a class="anchor" id="autotoc_md179"></a>
DOF Handler</h2>
<p>A DOF handler manages the relationship between the finite element space and the underlying mesh by mapping local shape functions to global shape functions. In <b>LehrFEM++</b>, this is done through objects of the type <code><a class="el" href="classlf_1_1assemble_1_1_dof_handler.html" title="A general (interface) class for DOF handling, see Lecture Document Paragraph 2.7.4....">lf::assemble::DofHandler</a></code>.</p>
<p>The key methods provided by the <code>DofHandler</code> interface are:</p><ul>
<li><code>NumDofs()</code>: Returns the total number of global DOFs.</li>
<li><code>NumLocalDofs(const <a class="el" href="classlf_1_1mesh_1_1_entity.html" title="Interface class representing a topological entity in a cellular complex">lf::mesh::Entity</a> &amp;)</code>: Provides the number of DOFs associated with a particular geometric entity.</li>
<li><code>GlobalDofIndices(const <a class="el" href="classlf_1_1mesh_1_1_entity.html" title="Interface class representing a topological entity in a cellular complex">lf::mesh::Entity</a> &amp;)</code>: Returns the global indices of DOFs associated with a given entity.</li>
<li><code>NumInteriorDofs(const <a class="el" href="classlf_1_1mesh_1_1_entity.html" title="Interface class representing a topological entity in a cellular complex">lf::mesh::Entity</a> &amp;)</code>: Specifies how many DOFs are associated with an entityâ€™s interior.</li>
</ul>
<h2><a class="anchor" id="autotoc_md180"></a>
Local to Global Index Mapping</h2>
<p>DOF handlers use index mapping to associate local shape functions on elements to global DOFs. The mapping follows a convention to ensure consistent assembly of the global system. The basic function is represented as:</p>
<div class="fragment"><div class="line">locglobmap(K, i) = j</div>
</div><!-- fragment --><p>Where:</p>
<ul>
<li>K refers to a mesh entity (such as a cell).</li>
<li>i is the local index of the shape function.</li>
<li>j is the corresponding global index.</li>
<li>For example, for linear Lagrangian elements on triangular meshes, the following local-to-global map might apply:</li>
</ul>
<div class="fragment"><div class="line">locglobmap(K, 0) = 2</div>
<div class="line">locglobmap(K, 1) = 7</div>
<div class="line">locglobmap(K, 2) = 9</div>
</div><!-- fragment --><p>Global shape functions (DOFs) in LehrFEM++ follow a numbering convention based on the geometric entities they are associated with:</p>
<p>Points (Vertices)</p><ol type="1">
<li>Edges</li>
<li>Cells (Triangles or Quadrilaterals)</li>
<li>DOFs associated with lower-dimensional entities (e.g., points and edges) are numbered first, followed by higher-dimensional ones (cells). Within each category, entities are numbered according to their intrinsic indexing as returned by the Index() function.</li>
</ol>
<h2><a class="anchor" id="autotoc_md181"></a>
Example: UniformFEDofHandler</h2>
<p>A commonly used DOF handler in LehrFEM++ is the <a class="el" href="classlf_1_1assemble_1_1_uniform_f_e_dof_handler.html" title="Dofhandler for uniform finite element spaces.">lf::assemble::UniformFEDofHandler</a>. It sets up local-to-global index mappings where the number of DOFs is constant for all entities of the same type:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classlf_1_1assemble_1_1_uniform_f_e_dof_handler.html">lf::assemble::UniformFEDofHandler</a> dof_handler(</div>
<div class="line">  mesh_p, {{<a class="code hl_function" href="classlf_1_1base_1_1_ref_el.html#ab4167c45a6c22d9b8dd49218d4aedc51">lf::base::RefEl::kPoint</a>(), 1},</div>
<div class="line">           {<a class="code hl_function" href="classlf_1_1base_1_1_ref_el.html#a415d06db9dee088b67e47b94bdf53db7">lf::base::RefEl::kSegment</a>(), 2},</div>
<div class="line">           {<a class="code hl_function" href="classlf_1_1base_1_1_ref_el.html#ac6542f1b3d68028bc0bd8d9a223b35ff">lf::base::RefEl::kTria</a>(), 1},</div>
<div class="line">           {<a class="code hl_function" href="classlf_1_1base_1_1_ref_el.html#ae28ad009a99541ecd2ab24999aebcf63">lf::base::RefEl::kQuad</a>(), 4}});</div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_uniform_f_e_dof_handler_html"><div class="ttname"><a href="classlf_1_1assemble_1_1_uniform_f_e_dof_handler.html">lf::assemble::UniformFEDofHandler</a></div><div class="ttdoc">Dofhandler for uniform finite element spaces.</div><div class="ttdef"><b>Definition</b> <a href="dofhandler_8h_source.html#l00260">dofhandler.h:260</a></div></div>
<div class="ttc" id="aclasslf_1_1base_1_1_ref_el_html_a415d06db9dee088b67e47b94bdf53db7"><div class="ttname"><a href="classlf_1_1base_1_1_ref_el.html#a415d06db9dee088b67e47b94bdf53db7">lf::base::RefEl::kSegment</a></div><div class="ttdeci">static constexpr RefEl kSegment()</div><div class="ttdoc">Returns the (1-dimensional) reference segment.</div><div class="ttdef"><b>Definition</b> <a href="ref__el_8h_source.html#l00153">ref_el.h:153</a></div></div>
<div class="ttc" id="aclasslf_1_1base_1_1_ref_el_html_ab4167c45a6c22d9b8dd49218d4aedc51"><div class="ttname"><a href="classlf_1_1base_1_1_ref_el.html#ab4167c45a6c22d9b8dd49218d4aedc51">lf::base::RefEl::kPoint</a></div><div class="ttdeci">static constexpr RefEl kPoint()</div><div class="ttdoc">Returns the (0-dimensional) reference point.</div><div class="ttdef"><b>Definition</b> <a href="ref__el_8h_source.html#l00144">ref_el.h:144</a></div></div>
<div class="ttc" id="aclasslf_1_1base_1_1_ref_el_html_ac6542f1b3d68028bc0bd8d9a223b35ff"><div class="ttname"><a href="classlf_1_1base_1_1_ref_el.html#ac6542f1b3d68028bc0bd8d9a223b35ff">lf::base::RefEl::kTria</a></div><div class="ttdeci">static constexpr RefEl kTria()</div><div class="ttdoc">Returns the reference triangle.</div><div class="ttdef"><b>Definition</b> <a href="ref__el_8h_source.html#l00161">ref_el.h:161</a></div></div>
<div class="ttc" id="aclasslf_1_1base_1_1_ref_el_html_ae28ad009a99541ecd2ab24999aebcf63"><div class="ttname"><a href="classlf_1_1base_1_1_ref_el.html#ae28ad009a99541ecd2ab24999aebcf63">lf::base::RefEl::kQuad</a></div><div class="ttdeci">static constexpr RefEl kQuad()</div><div class="ttdoc">Returns the reference quadrilateral.</div><div class="ttdef"><b>Definition</b> <a href="ref__el_8h_source.html#l00169">ref_el.h:169</a></div></div>
</div><!-- fragment --><p> This means:</p>
<ul>
<li>Each node carries 1 DOF.</li>
<li>Each edge carries 2 DOFs.</li>
<li>Each triangle has 1 DOF.</li>
<li>Each quadrilateral has 4 DOFs.</li>
</ul>
<h2><a class="anchor" id="autotoc_md182"></a>
Special Conventions</h2>
<p>In LehrFEM++, DOFs associated with lower-dimensional entities are numbered first. For example, DOFs on points (nodes) are numbered before those on edges. This is simply a convention to ensure consistent assembly and output.</p>
<h2><a class="anchor" id="autotoc_md183"></a>
Important Methods</h2>
<p>Here are some common functions and their usage in DofHandler:</p>
<ul>
<li>DOF Information Extraction: The GlobalDofIndices() method can be used to extract global DOF indices covering any geometric entity. Similarly, NumLocalDofs() provides the count of DOFs on each entity.</li>
<li>Interior DOFs: The InteriorGlobalDofIndices() function returns the indices of global shape functions associated with the interior of a given entity. This is particularly useful when dealing with higher-order elements where some DOFs are attached to edges or faces rather than vertices.</li>
</ul>
<h2><a class="anchor" id="autotoc_md184"></a>
Example Code</h2>
<p>An example of using a DofHandler to print information about local-to-global mappings in LehrFEM++:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> printDofInfo(<span class="keyword">const</span> <a class="code hl_class" href="classlf_1_1assemble_1_1_dof_handler.html">lf::assemble::DofHandler</a> &amp;dofh) {</div>
<div class="line">  <span class="keyword">auto</span> mesh = dofh.<a class="code hl_function" href="classlf_1_1assemble_1_1_dof_handler.html#a107c1a28661675cb9d64ee7cc28865ce">Mesh</a>();</div>
<div class="line">  size_type N_dofs = dofh.<a class="code hl_function" href="classlf_1_1assemble_1_1_dof_handler.html#abb2653388e7c8ee14bd835c1bd854a89">NumDofs</a>();</div>
<div class="line">  </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;DofHandler (&quot;</span> &lt;&lt; N_dofs &lt;&lt; <span class="stringliteral">&quot; dofs):\n&quot;</span>;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="group__lftypes.html#gae3a29f90c063bb1bebe232ce17a155e6">lf::base::dim_t</a> codim = 0; codim &lt;= mesh-&gt;DimMesh(); ++codim) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_class" href="classlf_1_1mesh_1_1_entity.html">lf::mesh::Entity</a> *e : mesh-&gt;Entities(codim)) {</div>
<div class="line">      size_type no_dofs = dofh.<a class="code hl_function" href="classlf_1_1assemble_1_1_dof_handler.html#ab648d0a3d773d411358b7d6fdaf2c698">NumLocalDofs</a>(*e);</div>
<div class="line">      <span class="keyword">auto</span> dof_array = dofh.<a class="code hl_function" href="classlf_1_1assemble_1_1_dof_handler.html#a9ef2112962f511c8ffc0ab20d68fa61a">GlobalDofIndices</a>(*e);</div>
<div class="line">      </div>
<div class="line">      std::cout &lt;&lt; *e &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; no_dofs &lt;&lt; <span class="stringliteral">&quot; dofs = [&quot;</span>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> loc_dof_idx = 0; loc_dof_idx &lt; no_dofs; ++loc_dof_idx) {</div>
<div class="line">        std::cout &lt;&lt; dof_array[loc_dof_idx] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_dof_handler_html"><div class="ttname"><a href="classlf_1_1assemble_1_1_dof_handler.html">lf::assemble::DofHandler</a></div><div class="ttdoc">A general (interface) class for DOF handling, see Lecture Document Paragraph 2.7.4....</div><div class="ttdef"><b>Definition</b> <a href="dofhandler_8h_source.html#l00112">dofhandler.h:112</a></div></div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_dof_handler_html_a107c1a28661675cb9d64ee7cc28865ce"><div class="ttname"><a href="classlf_1_1assemble_1_1_dof_handler.html#a107c1a28661675cb9d64ee7cc28865ce">lf::assemble::DofHandler::Mesh</a></div><div class="ttdeci">virtual std::shared_ptr&lt; const lf::mesh::Mesh &gt; Mesh() const =0</div><div class="ttdoc">Acess to underlying mesh object.</div></div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_dof_handler_html_a9ef2112962f511c8ffc0ab20d68fa61a"><div class="ttname"><a href="classlf_1_1assemble_1_1_dof_handler.html#a9ef2112962f511c8ffc0ab20d68fa61a">lf::assemble::DofHandler::GlobalDofIndices</a></div><div class="ttdeci">virtual std::span&lt; const gdof_idx_t &gt; GlobalDofIndices(const lf::mesh::Entity &amp;entity) const =0</div><div class="ttdoc">access to indices of global dof's belonging to an entity</div></div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_dof_handler_html_ab648d0a3d773d411358b7d6fdaf2c698"><div class="ttname"><a href="classlf_1_1assemble_1_1_dof_handler.html#ab648d0a3d773d411358b7d6fdaf2c698">lf::assemble::DofHandler::NumLocalDofs</a></div><div class="ttdeci">virtual size_type NumLocalDofs(const lf::mesh::Entity &amp;entity) const =0</div><div class="ttdoc">tells the number of degrees of freedom subordinate/_belonging_ to to an entity</div></div>
<div class="ttc" id="aclasslf_1_1assemble_1_1_dof_handler_html_abb2653388e7c8ee14bd835c1bd854a89"><div class="ttname"><a href="classlf_1_1assemble_1_1_dof_handler.html#abb2653388e7c8ee14bd835c1bd854a89">lf::assemble::DofHandler::NumDofs</a></div><div class="ttdeci">virtual size_type NumDofs() const =0</div><div class="ttdoc">total number of dof's handled by the object</div></div>
<div class="ttc" id="aclasslf_1_1mesh_1_1_entity_html"><div class="ttname"><a href="classlf_1_1mesh_1_1_entity.html">lf::mesh::Entity</a></div><div class="ttdoc">Interface class representing a topological entity in a cellular complex</div><div class="ttdef"><b>Definition</b> <a href="entity_8h_source.html#l00042">entity.h:42</a></div></div>
<div class="ttc" id="agroup__lftypes_html_gae3a29f90c063bb1bebe232ce17a155e6"><div class="ttname"><a href="group__lftypes.html#gae3a29f90c063bb1bebe232ce17a155e6">lf::base::dim_t</a></div><div class="ttdeci">unsigned int dim_t</div><div class="ttdoc">type for dimensions and co-dimensions and numbers derived from them</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00032">types.h:32</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
